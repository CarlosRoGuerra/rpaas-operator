language: go
sudo: required
addons:
  apt:
    packages:
      - docker-ce
install:
  - go get -u github.com/golang/dep/cmd/dep
  - mkdir -p $GOPATH/src/github.com/operator-framework && cd $GOPATH/src/github.com/operator-framework
  - git clone https://github.com/operator-framework/operator-sdk.git
  - cd operator-sdk && make dep && make install
  - cd $TRAVIS_BUILD_DIR
jobs:
  fast_finish: true
  include:
  - stage: test
    script: make test
    env: GOARCH=amd64
    go: "1.10.x"
  - stage: test
    script: make test
    env: GOARCH=amd64
    go: "master"
  - stage: build
    script: make build
    env: GOARCH=amd64
    go: "1.10.x"
  - stage: build
    script: make build
    env: GOARCH=amd64
    go: "master"
matrix:
  allow_failures:
    - go: master
